(()=>{"use strict";var e=".popup__button-save",t="popup__button-save_disabled",n="popup__input_error",o="popup__span-error_active",c=document.querySelectorAll(".popup__input"),r=document.querySelectorAll(".popup__form"),a=document.querySelectorAll(e),i=document.querySelector(e);function u(t){var n=t.target.querySelector(e);t.onload||(n.textContent="Сохранение..."),n.textContent="Сохранить"}function s(e){e.classList.remove(n),e.nextElementSibling.classList.remove(o)}console.dir(i);var l="deabbb0f24329babe7d5d647",d=document.querySelector(".popup__edit-profile"),p=document.querySelector(".popup__add-card"),m=document.querySelector(".popup__view-image"),f=document.querySelector(".profile__title"),h=document.querySelector(".profile__subtitle"),_=document.querySelector(".profile__edit-button"),v=document.querySelector(".profile__add-button"),y=document.querySelector('input[name="fullname"]'),b=document.querySelector('input[name="profession"]'),g=document.querySelector('input[name="image-name"]'),S=document.querySelector('input[name="image-link"]'),q=document.querySelector('form[name="edit-form"]'),k=document.querySelector('form[name="add-form"]'),E=document.querySelector(".popup__update-avatar"),L=document.querySelector(".profile__avatar-image"),C=document.querySelector('form[name="update-avatar-form"]'),j=document.querySelector('input[name="avatar-link"]');function x(e){a.forEach((function(e){e.classList.add(t),e.disabled=!0})),function(e){var t=e.querySelector(".popup__button-close");e.addEventListener("mousedown",(function(n){n.target===t&&N(e),n.target===e&&N(e)})),document.addEventListener("keydown",w)}(e),e.classList.add("popup_opened")}function N(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",w),r.forEach((function(e){e.reset()})),c.forEach((function(e){s(e)}))}function w(e){"Escape"===e.code&&N(document.querySelector(".popup_opened"))}L.addEventListener("click",(function(){x(E)})),_.addEventListener("click",(function(){x(d),y.value=f.textContent,b.value=h.textContent})),v.addEventListener("click",(function(){x(p)}));var P=document.querySelector("#card").content,T=document.querySelector(".elements"),z=P.querySelector(".element"),O=document.querySelector(".popup__image"),J=(z.querySelector(".element__image"),z.querySelector(".element__title"),document.querySelector(".popup__title"));function A(e){var t=z.cloneNode(!0),n=t.querySelector(".element__image"),o=t.querySelector(".element__title"),c=t.querySelector(".element__like-button"),r=t.querySelector(".element__delete-button"),a=t.querySelector(".element__like-count");if(t.addEventListener("click",(function(e){var t;e.target===c&&(c.classList.contains("element__like-button_active")?(c.classList.remove("element__like-button_active"),a.textContent="".concat(+a.textContent-1),function(e){fetch("https://nomoreparties.co/v1/wbc-cohort-1/cards/likes/".concat(e),{method:"DELETE",headers:{authorization:"f69a8e1a-7b4c-4898-9f33-97539dca3c0c","Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}(e.target.parentNode.parentNode.parentNode.id)):(c.classList.add("element__like-button_active"),a.textContent="".concat(+a.textContent+1),t=e.target.parentNode.parentNode.parentNode.id,fetch("https://nomoreparties.co/v1/wbc-cohort-1/cards/likes/".concat(t),{method:"PUT",headers:{authorization:"f69a8e1a-7b4c-4898-9f33-97539dca3c0c","Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){console.log(e)})).catch((function(e){console.log(e)})))),e.target===n&&(O.src=e.target.src,O.alt=e.target.alt,J.textContent=o.textContent,x(m)),e.target===r&&(r.parentNode.remove(),function(e){fetch("https://nomoreparties.co/v1/wbc-cohort-1/cards/".concat(e),{method:"DELETE",headers:{authorization:"f69a8e1a-7b4c-4898-9f33-97539dca3c0c","Content-Type":"application/json"},body:JSON.stringify({})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}(e.target.parentNode.id))})),n.src=e.link,n.alt=e.name,o.textContent=e.name,a.textContent=e.likes.length,t.id=e._id,e.owner._id!==l&&r.remove(),0!==e.likes.length)for(var i=0;i<e.likes.length;i++)e.likes[i]._id===l&&c.classList.add("element__like-button_active");return t}q.addEventListener("submit",(function(e){e.preventDefault(),f.textContent=y.value,h.textContent=b.value,fetch("https://nomoreparties.co/v1/wbc-cohort-1/users/me",{method:"PATCH",headers:{authorization:"f69a8e1a-7b4c-4898-9f33-97539dca3c0c","Content-Type":"application/json"},body:JSON.stringify({name:f.textContent,about:h.textContent})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){console.log(e)})).catch((function(e){console.log(e)})),u(e),N(d)})),k.addEventListener("submit",(function(e){e.preventDefault();var t,n={_id:"",link:S.value,name:g.value,likes:[],owner:{_id:l}};T.prepend(A(n)),t=n,fetch("https://nomoreparties.co/v1/wbc-cohort-1/cards",{method:"POST",headers:{authorization:"f69a8e1a-7b4c-4898-9f33-97539dca3c0c","Content-Type":"application/json"},body:JSON.stringify({name:g.value,link:S.value,likes:t.likes.length})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){console.log(e)})).catch((function(e){console.log(e)})),u(e),N(p)})),C.addEventListener("submit",(function(e){e.preventDefault(),console.log(j.value),L.src=j.value,fetch("https://nomoreparties.co/v1/wbc-cohort-1/users/me/avatar",{method:"PATCH",headers:{authorization:"f69a8e1a-7b4c-4898-9f33-97539dca3c0c","Content-Type":"application/json"},body:JSON.stringify({avatar:L.src})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){console.log(e)})).catch((function(e){console.log(e)})),u(e),N(E)})),c.forEach((function(e){e.addEventListener("input",(function(e){e.target.validity.valid||function(e){e.classList.add(n),e.nextElementSibling.classList.add(o)}(e.target),e.target.validity.valid&&s(e.target)}))})),r.forEach((function(n){n.addEventListener("input",(function(n){var o=n.target.form,c=o.checkValidity();c?(o.querySelector(e).classList.remove(t),o.querySelector(e).disabled=!c):(o.querySelector(e).classList.add(t),o.querySelector(e).disabled=!c)}))})),fetch("https://nomoreparties.co/v1/wbc-cohort-1/users/me",{headers:{authorization:"f69a8e1a-7b4c-4898-9f33-97539dca3c0c"}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){f.textContent=e.name,h.textContent=e.about;var t=e._id;return L.src=e.avatar,t})).then((function(){return fetch("https://nomoreparties.co/v1/wbc-cohort-1/cards ",{headers:{authorization:"f69a8e1a-7b4c-4898-9f33-97539dca3c0c"}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){var t;t=e,Object.keys(t).forEach((function(e){T.append(A(t[e]))}))})).catch((function(e){console.log(e)}))}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoibUJBRUEsSUFBTUEsRUFHa0Isc0JBSGxCQSxFQUlpQiw4QkFKakJBLEVBS2EscUJBTGJBLEVBTVEsMkJBR1JDLEVBQVlDLFNBQVNDLGlCQVBWLGlCQVFYQyxFQUFXRixTQUFTQyxpQkFUVixnQkFVVkUsRUFBaUJILFNBQVNDLGlCQUFpQkgsR0FDM0NNLEVBQWFKLFNBQVNLLGNBQWNQLEdBRzFDLFNBQVNRLEVBQWFDLEdBQ3BCLElBQU1DLEVBQU9ELEVBQUlFLE9BQU9KLGNBQWNQLEdBQ2pDUyxFQUFJRyxTQUNQRixFQUFLRyxZQUFjLGlCQUVuQkgsRUFBS0csWUFBYyxXQUN0QixDQVNELFNBQVNDLEVBQVVKLEdBQ2pCQSxFQUFLSyxVQUFVQyxPQUFPaEIsR0FDdEJVLEVBQUtPLG1CQUFtQkYsVUFBVUMsT0FBT2hCLEVBQzFDLENBcEJEa0IsUUFBUUMsSUFBSWIsR0NHWixJQUVFYyxFQUFPLDJCQ2xCSEMsRUFBZW5CLFNBQVNLLGNBQWMsd0JBQ3RDZSxFQUFZcEIsU0FBU0ssY0FBYyxvQkFDbkNnQixFQUFhckIsU0FBU0ssY0FBYyxzQkFDcENpQixFQUFjdEIsU0FBU0ssY0FBYyxtQkFDckNrQixFQUFvQnZCLFNBQVNLLGNBQWMsc0JBQzNDbUIsRUFBb0J4QixTQUFTSyxjQUFjLHlCQUMzQ29CLEVBQWdCekIsU0FBU0ssY0FBYyx3QkFDdkNxQixFQUFnQjFCLFNBQVNLLGNBQWMsMEJBQ3ZDc0IsRUFBa0IzQixTQUFTSyxjQUFjLDRCQUN6Q3VCLEVBQW9CNUIsU0FBU0ssY0FBYyw0QkFDM0N3QixFQUFvQjdCLFNBQVNLLGNBQWMsNEJBQzNDeUIsRUFBa0I5QixTQUFTSyxjQUFjLDBCQUN6QzBCLEVBQWUvQixTQUFTSyxjQUFjLHlCQUN0QzJCLEVBQW9CaEMsU0FBU0ssY0FBYyx5QkFDM0M0QixFQUFjakMsU0FBU0ssY0FBYywwQkFDckM2QixFQUFtQmxDLFNBQVNLLGNBQWMsbUNBQzFDOEIsRUFBa0JuQyxTQUFTSyxjQUFjLDZCQXlCL0MsU0FBUytCLEVBQVVDLEdGakJqQmxDLEVBQWVtQyxTQUFRLFNBQUM5QixHQUN0QkEsRUFBS0ssVUFBVTBCLElBQUl6QyxHQUNuQlUsRUFBS2dDLFVBQVcsQ0FDakIsSUU2Q0gsU0FBMkJILEdBQ3pCLElBQU1JLEVBQWNKLEVBQU1oQyxjQUFjLHdCQUN4Q2dDLEVBQU1LLGlCQUFpQixhQUFhLFNBQUNuQyxHQUMvQkEsRUFBSUUsU0FBV2dDLEdBQ2pCRSxFQUFXTixHQUVUOUIsRUFBSUUsU0FBVzRCLEdBQ2pCTSxFQUFXTixFQUVkLElBQ0RyQyxTQUFTMEMsaUJBQWlCLFVBQVdFLEVBQ3RDLENBeENDQyxDQUFrQlIsR0FDbEJBLEVBQU14QixVQUFVMEIsSUFBSSxlQUNyQixDQUVELFNBQVNJLEVBQVdOLEdBQ2xCQSxFQUFNeEIsVUFBVUMsT0FBTyxnQkFDdkJkLFNBQVM4QyxvQkFBb0IsVUFBV0YsR0FDeEMxQyxFQUFTb0MsU0FBUSxTQUFDOUIsR0FDaEJBLEVBQUt1QyxPQUNOLElBQ0RoRCxFQUFVdUMsU0FBUSxTQUFDOUIsR0FDakJJLEVBQVVKLEVBQ1gsR0FDRixDQTZCRCxTQUFTb0MsRUFBZXJDLEdBQ0wsV0FBYkEsRUFBSXlDLE1BRU5MLEVBRG9CM0MsU0FBU0ssY0FBYyxpQkFHOUMsQ0FoQ0Q0QixFQUFZUyxpQkFBaUIsU0FBUyxXQUNwQ04sRUFBVUosRUFDWCxJQUVEUixFQUFrQmtCLGlCQUFpQixTQUFTLFdBQzFDTixFQUFVakIsR0FDVk8sRUFBY3VCLE1BQVEzQixFQUFZWCxZQUNsQ2dCLEVBQWdCc0IsTUFBUTFCLEVBQWtCWixXQUMzQyxJQUVEYyxFQUFjaUIsaUJBQWlCLFNBQVMsV0FDdENOLEVBQVVoQixFQUNYLElDekRELElBQU04QixFQUFlbEQsU0FBU0ssY0FBYyxTQUFTOEMsUUFDL0NDLEVBQVdwRCxTQUFTSyxjQUFjLGFBQ2xDZ0QsRUFBT0gsRUFBYTdDLGNBQWMsWUFDbENpRCxFQUFrQnRELFNBQVNLLGNBQWMsaUJBR3pDa0QsR0FGWUYsRUFBS2hELGNBQWMsbUJBQ25CZ0QsRUFBS2hELGNBQWMsbUJBQ2JMLFNBQVNLLGNBQWMsa0JBZ0IvQyxTQUFTbUQsRUFBV2hELEdBQ2xCLElBQU1pRCxFQUFjSixFQUFLSyxXQUFVLEdBQ2pDQyxFQUFtQkYsRUFBWXBELGNBQWMsbUJBQzdDdUQsRUFBbUJILEVBQVlwRCxjQUFjLG1CQUM3Q3dELEVBQXdCSixFQUFZcEQsY0FBYyx5QkFDbER5RCxFQUEwQkwsRUFBWXBELGNBQWMsMkJBQ3BEMEQsRUFBWU4sRUFBWXBELGNBQWMsd0JBaUN4QyxHQWhDQW9ELEVBQVlmLGlCQUFpQixTQUFTLFNBQUNuQyxHRm1HekMsSUFBaUJ5RCxFRWxHVHpELEVBQUlFLFNBQVdvRCxJQUNaQSxFQUFzQmhELFVBQVVvRCxTQUFTLGdDQU01Q0osRUFBc0JoRCxVQUFVQyxPQUFPLCtCQUN2Q2lELEVBQVVwRCxZQUFWLFdBQTRCb0QsRUFBVXBELFlBQWMsR0ZrSDVELFNBQW9CcUQsR0FDWEUsTUFBTSx3REFBRCxPQUF5REYsR0FBVSxDQUM3RUcsT0FBUSxTQUNSQyxRQUFTLENBQ1BDLGNBQWUsdUNBQ2YsZUFBZ0Isb0JBRWxCQyxLQUFNQyxLQUFLQyxVQUFVLENBQUMsS0FHckJDLE1BQUssU0FBQUMsR0FDSixPQUFJQSxFQUFJQyxHQUNDRCxFQUFJRSxPQUVOQyxRQUFRQyxPQUFSLGtCQUEwQkosRUFBSUssUUFDdEMsSUFDQU4sTUFBSyxTQUFDTyxHQUNMaEUsUUFBUWlFLElBQUlELEVBQ2IsSUFDQUUsT0FBTSxTQUFDQyxHQUNObkUsUUFBUWlFLElBQUlFLEVBQ2IsR0FDSixDRXZJT0MsQ0FBVzdFLEVBQUlFLE9BQU80RSxXQUFXQSxXQUFXQSxXQUFXQyxNQVB2RHpCLEVBQXNCaEQsVUFBVTBCLElBQUksK0JBQ3BDd0IsRUFBVXBELFlBQVYsV0FBNEJvRCxFQUFVcEQsWUFBYyxHRitGM0NxRCxFRTlGRHpELEVBQUlFLE9BQU80RSxXQUFXQSxXQUFXQSxXQUFXQyxHRitGbkRwQixNQUFNLHdEQUFELE9BQXlERixHQUFVLENBQzdFRyxPQUFRLE1BQ1JDLFFBQVMsQ0FDUEMsY0FBZSx1Q0FDZixlQUFnQixvQkFFbEJDLEtBQU1DLEtBQUtDLFVBQVUsQ0FBQyxLQUdyQkMsTUFBSyxTQUFBQyxHQUNKLE9BQUlBLEVBQUlDLEdBQ0NELEVBQUlFLE9BRU5DLFFBQVFDLE9BQVIsa0JBQTBCSixFQUFJSyxRQUN0QyxJQUNBTixNQUFLLFNBQUNPLEdBQ0xoRSxRQUFRaUUsSUFBSUQsRUFDYixJQUNBRSxPQUFNLFNBQUNDLEdBQ05uRSxRQUFRaUUsSUFBSUUsRUFDYixNRTNHRzVFLEVBQUlFLFNBQVdrRCxJQUNqQkwsRUFBZ0JpQyxJQUFNaEYsRUFBSUUsT0FBTzhFLElBQ2pDakMsRUFBZ0JrQyxJQUFNakYsRUFBSUUsT0FBTytFLElBQ2pDakMsRUFBZ0I1QyxZQUFjaUQsRUFBaUJqRCxZQUMvQ3lCLEVBQVVmLElBRVJkLEVBQUlFLFNBQVdxRCxJQUNqQkEsRUFBd0J1QixXQUFXdkUsU0ZnSXpDLFNBQW9Ca0QsR0FDWEUsTUFBTSxrREFBRCxPQUFtREYsR0FBVSxDQUN2RUcsT0FBUSxTQUNSQyxRQUFTLENBQ1BDLGNBQWUsdUNBQ2YsZUFBZ0Isb0JBRWxCQyxLQUFNQyxLQUFLQyxVQUFVLENBQUMsS0FHckJDLE1BQUssU0FBQUMsR0FDSixPQUFJQSxFQUFJQyxHQUNDRCxFQUFJRSxPQUVOQyxRQUFRQyxPQUFSLGtCQUEwQkosRUFBSUssUUFDdEMsSUFDQU4sTUFBSyxTQUFDTyxHQUNMaEUsUUFBUWlFLElBQUlELEVBQ2IsSUFDQUUsT0FBTSxTQUFDQyxHQUNObkUsUUFBUWlFLElBQUlFLEVBQ2IsR0FDSixDRXJKS00sQ0FBV2xGLEVBQUlFLE9BQU80RSxXQUFXQyxJQUVwQyxJQUNEM0IsRUFBaUI0QixJQUFNL0UsRUFBS2tGLEtBQzVCL0IsRUFBaUI2QixJQUFNaEYsRUFBS21GLEtBQzVCL0IsRUFBaUJqRCxZQUFjSCxFQUFLbUYsS0FDcEM1QixFQUFVcEQsWUFBY0gsRUFBS29GLE1BQU1DLE9BQ25DcEMsRUFBWTZCLEdBQUs5RSxFQUFLc0YsSUFDbEJ0RixFQUFLdUYsTUFBTUQsTUFBUTVFLEdBQ3JCNEMsRUFBd0JoRCxTQUVBLElBQXRCTixFQUFLb0YsTUFBTUMsT0FDYixJQUFLLElBQUlHLEVBQUksRUFBR0EsRUFBSXhGLEVBQUtvRixNQUFNQyxPQUFRRyxJQUNwQ3hGLEVBQUtvRixNQUFNSSxHQUFHRixNQUFRNUUsR0FDdkIyQyxFQUFzQmhELFVBQVUwQixJQUFJLCtCQUl4QyxPQUFPa0IsQ0FDUixDRFdDM0IsRUFBZ0JZLGlCQUFpQixVQUFVLFNBQUNuQyxHQUMxQ0EsRUFBSTBGLGlCQUNKM0UsRUFBWVgsWUFBY2UsRUFBY3VCLE1BQ3hDMUIsRUFBa0JaLFlBQWNnQixFQUFnQnNCLE1EakMzQ2lCLE1BQU0sb0RBQXFELENBQ2hFQyxPQUFRLFFBQ1JDLFFBQVMsQ0FDUEMsY0FBZSx1Q0FDZixlQUFnQixvQkFFbEJDLEtBQU1DLEtBQUtDLFVBQVUsQ0FDbkJtQixLQUFNckUsRUFBWVgsWUFDbEJ1RixNQUFPM0UsRUFBa0JaLGdCQUcxQjhELE1BQUssU0FBQUMsR0FDSixPQUFJQSxFQUFJQyxHQUNDRCxFQUFJRSxPQUVOQyxRQUFRQyxPQUFSLGtCQUEwQkosRUFBSUssUUFDdEMsSUFDQU4sTUFBSyxTQUFDTyxHQUNMaEUsUUFBUWlFLElBQUlELEVBQ2IsSUFDQUUsT0FBTSxTQUFDQyxHQUNObkUsUUFBUWlFLElBQUlFLEVBQ2IsSUNhRDdFLEVBQWFDLEdBQ2JvQyxFQUFXeEIsRUFDWixJQUNEWSxFQUFhVyxpQkFBaUIsVUFBVSxTQUFDbkMsR0FDdkNBLEVBQUkwRixpQkFDSixJRFdnQkUsRUNYWkMsRUFBVSxDQUNaTixJQUFLLEdBQ0xKLEtBQU03RCxFQUFrQm9CLE1BQ3hCMEMsS0FBTS9ELEVBQWtCcUIsTUFDeEIyQyxNQUFPLEdBQ1BHLE1BQU8sQ0FDTEQsSUFBSzVFLElBR1RrQyxFQUFTaUQsUUFBUTdDLEVBQVc0QyxJREVaRCxFQ0RMQyxFREVObEMsTUFBTSxpREFBa0QsQ0FDN0RDLE9BQVEsT0FDUkMsUUFBUyxDQUNQQyxjQUFlLHVDQUNmLGVBQWdCLG9CQUVsQkMsS0FBTUMsS0FBS0MsVUFBVSxDQUNuQm1CLEtBQU0vRCxFQUFrQnFCLE1BQ3hCeUMsS0FBTTdELEVBQWtCb0IsTUFDeEIyQyxNQUFPTyxFQUFJUCxNQUFNQyxXQUdsQnBCLE1BQUssU0FBQUMsR0FDSixPQUFJQSxFQUFJQyxHQUNDRCxFQUFJRSxPQUVOQyxRQUFRQyxPQUFSLGtCQUEwQkosRUFBSUssUUFDdEMsSUFDQU4sTUFBSyxTQUFDTyxHQUNMaEUsUUFBUWlFLElBQUlELEVBQ2IsSUFDQUUsT0FBTSxTQUFDQyxHQUNObkUsUUFBUWlFLElBQUlFLEVBQ2IsSUN4QkQ3RSxFQUFhQyxHQUNib0MsRUFBV3ZCLEVBQ1osSUFDRGMsRUFBaUJRLGlCQUFpQixVQUFVLFNBQUNuQyxHQUMzQ0EsRUFBSTBGLGlCQUNKakYsUUFBUWlFLElBQUk5QyxFQUFnQmMsT0FDNUJoQixFQUFZc0QsSUFBTXBELEVBQWdCYyxNRC9CN0JpQixNQUFNLDJEQUE0RCxDQUN2RUMsT0FBUSxRQUNSQyxRQUFTLENBQ1BDLGNBQWUsdUNBQ2YsZUFBZ0Isb0JBRWxCQyxLQUFNQyxLQUFLQyxVQUFVLENBQ25COEIsT0FBUXJFLEVBQVlzRCxRQUdyQmQsTUFBSyxTQUFBQyxHQUNKLE9BQUlBLEVBQUlDLEdBQ0NELEVBQUlFLE9BRU5DLFFBQVFDLE9BQVIsa0JBQTBCSixFQUFJSyxRQUN0QyxJQUNBTixNQUFLLFNBQUNPLEdBQ0xoRSxRQUFRaUUsSUFBSUQsRUFDYixJQUNBRSxPQUFNLFNBQUNDLEdBQ05uRSxRQUFRaUUsSUFBSUUsRUFDYixJQ1lEN0UsRUFBYUMsR0FDYm9DLEVBQVdYLEVBQ1osSUZuRkRqQyxFQUFVdUMsU0FBUSxTQUFDOUIsR0FDakJBLEVBQUtrQyxpQkFBaUIsU0FBUyxTQUFDbkMsR0FDekJBLEVBQUlFLE9BQU84RixTQUFTQyxPQVIvQixTQUFtQmhHLEdBQ2pCQSxFQUFLSyxVQUFVMEIsSUFBSXpDLEdBQ25CVSxFQUFLTyxtQkFBbUJGLFVBQVUwQixJQUFJekMsRUFDdkMsQ0FNTzJHLENBQVVsRyxFQUFJRSxRQUVaRixFQUFJRSxPQUFPOEYsU0FBU0MsT0FDdEI1RixFQUFVTCxFQUFJRSxPQUVqQixHQUNGLElBSURQLEVBQVNvQyxTQUFRLFNBQUM5QixHQUNoQkEsRUFBS2tDLGlCQUFpQixTQUFTLFNBQUNuQyxHQUM5QixJQUFNbUcsRUFBYW5HLEVBQUlFLE9BQU9rRyxLQUN4QkMsRUFBVUYsRUFBV0csZ0JBQ3RCRCxHQUtIRixFQUFXckcsY0FBY1AsR0FBZ0NlLFVBQVVDLE9BQU9oQixHQUMxRTRHLEVBQVdyRyxjQUFjUCxHQUFnQzBDLFVBQVlvRSxJQUxyRUYsRUFBV3JHLGNBQWNQLEdBQWdDZSxVQUFVMEIsSUFBSXpDLEdBQ3ZFNEcsRUFBV3JHLGNBQWNQLEdBQWdDMEMsVUFBWW9FLEVBTXhFLEdBQ0YsSUM5Q00xQyxNQUxHLG9EQUtRLENBQ2hCRSxRQUFTLENBQ1BDLGNBTkksMENBU0xJLE1BQUssU0FBQUMsR0FDSixPQUFJQSxFQUFJQyxHQUNDRCxFQUFJRSxPQUVOQyxRQUFRQyxPQUFSLGtCQUEwQkosRUFBSUssUUFDdEMsSUFDQU4sTUFBSyxTQUFDTyxHQUNMMUQsRUFBWVgsWUFBY3FFLEVBQU9XLEtBQ2pDcEUsRUFBa0JaLFlBQWNxRSxFQUFPa0IsTUFDdkMsSUFBTWhGLEVBQU84RCxFQUFPYyxJQUVwQixPQURBN0QsRUFBWXNELElBQU1QLEVBQU9zQixPQUNsQnBGLENBQ1IsSUFDQXVELE1BQUssV0FDSixPQUFPUCxNQUFNLGtEQUFtRCxDQUM5REUsUUFBUyxDQUNQQyxjQUFlLDBDQUdoQkksTUFBSyxTQUFBQyxHQUNKLE9BQUlBLEVBQUlDLEdBQ0NELEVBQUlFLE9BRU5DLFFBQVFDLE9BQVIsa0JBQTBCSixFQUFJSyxRQUN0QyxJQUNBTixNQUFLLFNBQUNPLEdFOUJmLElBQXlCOEIsSUYrQkM5QixFRTlCeEIrQixPQUFPQyxLQUFLRixHQUFLeEUsU0FBUSxTQUFDOUIsR0FDeEI0QyxFQUFTNkQsT0FBT3pELEVBQVdzRCxFQUFJdEcsSUFDaEMsR0Y2Qk0sSUFDQTBFLE9BQU0sU0FBQ0MsR0FDTm5FLFFBQVFpRSxJQUFJRSxFQUNiLEdBQ0osRyIsInNvdXJjZXMiOlsid2VicGFjazovL21lc3RvLXByb2plY3QtYm9vdGNhbXAvLi9zcmMvY29tcG9uZW50cy92YWxpZGF0ZS5qcyIsIndlYnBhY2s6Ly9tZXN0by1wcm9qZWN0LWJvb3RjYW1wLy4vc3JjL2NvbXBvbmVudHMvYXBpLmpzIiwid2VicGFjazovL21lc3RvLXByb2plY3QtYm9vdGNhbXAvLi9zcmMvY29tcG9uZW50cy9tb2RhbC5qcyIsIndlYnBhY2s6Ly9tZXN0by1wcm9qZWN0LWJvb3RjYW1wLy4vc3JjL2NvbXBvbmVudHMvY2FyZC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XHJcblxyXG5jb25zdCBzZWxlY3RvcnMgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiAnLnBvcHVwX19mb3JtJyxcclxuICBpbnB1dFNlbGVjdG9yOiAnLnBvcHVwX19pbnB1dCcsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6ICcucG9wdXBfX2J1dHRvbi1zYXZlJyxcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiAncG9wdXBfX2J1dHRvbi1zYXZlX2Rpc2FibGVkJyxcclxuICBpbnB1dEVycm9yQ2xhc3M6ICdwb3B1cF9faW5wdXRfZXJyb3InLFxyXG4gIGVycm9yQ2xhc3M6ICdwb3B1cF9fc3Bhbi1lcnJvcl9hY3RpdmUnXHJcbn07XHJcblxyXG5jb25zdCBhbGxJbnB1dHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9ycy5pbnB1dFNlbGVjdG9yKTtcclxuY29uc3QgYWxsRm9ybXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9ycy5mb3JtU2VsZWN0b3IpO1xyXG5jb25zdCBhbGxTYXZlQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3JzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuY29uc3Qgc2F2ZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3JzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuY29uc29sZS5kaXIoc2F2ZUJ1dHRvbik7XHJcblxyXG5mdW5jdGlvbiBsb2FkQ2FsbGJhY2soZXZ0KSB7XHJcbiAgY29uc3QgaXRlbSA9IGV2dC50YXJnZXQucXVlcnlTZWxlY3RvcihzZWxlY3RvcnMuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gIGlmICghZXZ0Lm9ubG9hZCkge1xyXG4gICAgaXRlbS50ZXh0Q29udGVudCA9ICfQodC+0YXRgNCw0L3QtdC90LjQtS4uLic7XHJcbiAgfVxyXG4gICAgaXRlbS50ZXh0Q29udGVudCA9ICfQodC+0YXRgNCw0L3QuNGC0YwnO1xyXG59XHJcblxyXG5mdW5jdGlvbiBkaXNhYmxlU2F2ZUJ1dHRvbigpIHtcclxuICBhbGxTYXZlQnV0dG9ucy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICBpdGVtLmNsYXNzTGlzdC5hZGQoc2VsZWN0b3JzLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgaXRlbS5kaXNhYmxlZCA9IHRydWU7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhpZGVFcnJvcihpdGVtKSB7XHJcbiAgaXRlbS5jbGFzc0xpc3QucmVtb3ZlKHNlbGVjdG9ycy5pbnB1dEVycm9yQ2xhc3MpO1xyXG4gIGl0ZW0ubmV4dEVsZW1lbnRTaWJsaW5nLmNsYXNzTGlzdC5yZW1vdmUoc2VsZWN0b3JzLmVycm9yQ2xhc3MpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzaG93RXJyb3IoaXRlbSkge1xyXG4gIGl0ZW0uY2xhc3NMaXN0LmFkZChzZWxlY3RvcnMuaW5wdXRFcnJvckNsYXNzKTtcclxuICBpdGVtLm5leHRFbGVtZW50U2libGluZy5jbGFzc0xpc3QuYWRkKHNlbGVjdG9ycy5lcnJvckNsYXNzKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFzSW52YWxpZCgpIHtcclxuICBhbGxJbnB1dHMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIChldnQpID0+IHtcclxuICAgICAgaWYgKCFldnQudGFyZ2V0LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgICAgc2hvd0Vycm9yKGV2dC50YXJnZXQpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChldnQudGFyZ2V0LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgICAgaGlkZUVycm9yKGV2dC50YXJnZXQpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gdG9nZ2xlU2F2ZUJ1dHRvbigpIHtcclxuICBhbGxGb3Jtcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKGV2dCkgPT4ge1xyXG4gICAgICBjb25zdCB0YXJnZXRGb3JtID0gZXZ0LnRhcmdldC5mb3JtO1xyXG4gICAgICBjb25zdCBpc1ZhbGlkID0gdGFyZ2V0Rm9ybS5jaGVja1ZhbGlkaXR5KCk7XHJcbiAgICAgIGlmICghaXNWYWxpZCkge1xyXG4gICAgICAgIHRhcmdldEZvcm0ucXVlcnlTZWxlY3RvcihzZWxlY3RvcnMuc3VibWl0QnV0dG9uU2VsZWN0b3IpLmNsYXNzTGlzdC5hZGQoc2VsZWN0b3JzLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICAgIHRhcmdldEZvcm0ucXVlcnlTZWxlY3RvcihzZWxlY3RvcnMuc3VibWl0QnV0dG9uU2VsZWN0b3IpLmRpc2FibGVkID0gIWlzVmFsaWQ7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgdGFyZ2V0Rm9ybS5xdWVyeVNlbGVjdG9yKHNlbGVjdG9ycy5zdWJtaXRCdXR0b25TZWxlY3RvcikuY2xhc3NMaXN0LnJlbW92ZShzZWxlY3RvcnMuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgICAgdGFyZ2V0Rm9ybS5xdWVyeVNlbGVjdG9yKHNlbGVjdG9ycy5zdWJtaXRCdXR0b25TZWxlY3RvcikuZGlzYWJsZWQgPSAhaXNWYWxpZDtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgaGFzSW52YWxpZCgpO1xyXG4gIHRvZ2dsZVNhdmVCdXR0b24oKTtcclxufVxyXG5cclxuZXhwb3J0IHtcclxuICBzZWxlY3RvcnMsXHJcbiAgYWxsSW5wdXRzLFxyXG4gIGFsbEZvcm1zLFxyXG4gIGRpc2FibGVTYXZlQnV0dG9uLFxyXG4gIGhpZGVFcnJvcixcclxuICBlbmFibGVWYWxpZGF0aW9uLFxyXG4gIGxvYWRDYWxsYmFja1xyXG59OyIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmltcG9ydCB7XHJcbiAgYWRkSW5pdGlhbENhcmRzLFxyXG4gIGNyZWF0ZUNhcmQsXHJcbiAgY2FyZExpc3QsXHJcbiAgZGVsZXRlQnV0dG9uc1xyXG59IGZyb20gJy4vY2FyZC5qcyc7XHJcblxyXG5pbXBvcnQge1xyXG4gIHByb2ZpbGVOYW1lLFxyXG4gIHByb2ZpbGVQcm9mZXNzaW9uLFxyXG4gIGFkZEltYWdlTmFtZUlucHV0LFxyXG4gIGFkZEltYWdlTGlua0lucHV0LFxyXG4gIGF2YXRhckltYWdlXHJcbn0gZnJvbSAnLi9tb2RhbCc7XHJcblxyXG4vLyDQv9C+0LvRg9GH0LDQtdC8INC00LDQvdC90YvQtSDQv9C+0LvRjNC30L7QstCw0YLQtdC70Y8g0Lgg0LzQsNGB0YHQuNCyINC60LDRgNGC0L7Rh9C10Log0YEg0YHQtdGA0LLQtdGA0LBcclxuY29uc3QgdXJsID0gJ2h0dHBzOi8vbm9tb3JlcGFydGllcy5jby92MS93YmMtY29ob3J0LTEvdXNlcnMvbWUnLFxyXG4gIHRva2VuID0gJ2Y2OWE4ZTFhLTdiNGMtNDg5OC05ZjMzLTk3NTM5ZGNhM2MwYycsXHJcbiAgbXlJRCA9ICdkZWFiYmIwZjI0MzI5YmFiZTdkNWQ2NDcnO1xyXG5cclxuZnVuY3Rpb24gZ2V0VXNlckluZm8oKSB7XHJcbiAgcmV0dXJuIGZldGNoKHVybCwge1xyXG4gICAgaGVhZGVyczoge1xyXG4gICAgICBhdXRob3JpemF0aW9uOiB0b2tlblxyXG4gICAgfVxyXG4gIH0pXHJcbiAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pXHJcbiAgICAudGhlbigocmVzdWx0KSA9PiB7XHJcbiAgICAgIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gcmVzdWx0Lm5hbWU7XHJcbiAgICAgIHByb2ZpbGVQcm9mZXNzaW9uLnRleHRDb250ZW50ID0gcmVzdWx0LmFib3V0O1xyXG4gICAgICBjb25zdCBteUlEID0gcmVzdWx0Ll9pZDsgLy8g0Y3RgtC+IGNvbnN0INC80L7QtdCz0L4gaWRcclxuICAgICAgYXZhdGFySW1hZ2Uuc3JjID0gcmVzdWx0LmF2YXRhcjtcclxuICAgICAgcmV0dXJuIG15SUQ7XHJcbiAgICB9KVxyXG4gICAgLnRoZW4oKCkgPT4geyAvLyDQv9C+0LvRg9GH0LDQtdC8INC80LDRgdGB0LjQsiDQutCw0YDRgtC+0YfQtdC6INGBINGB0LXRgNCy0LXRgNCwXHJcbiAgICAgIHJldHVybiBmZXRjaCgnaHR0cHM6Ly9ub21vcmVwYXJ0aWVzLmNvL3YxL3diYy1jb2hvcnQtMS9jYXJkcyAnLCB7XHJcbiAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgYXV0aG9yaXphdGlvbjogJ2Y2OWE4ZTFhLTdiNGMtNDg5OC05ZjMzLTk3NTM5ZGNhM2MwYydcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgICAgICAgYWRkSW5pdGlhbENhcmRzKHJlc3VsdCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59XHJcblxyXG4vLyDQvNC10L3Rj9C10Lwg0LTQsNC90L3Ri9C1INC/0YDQvtGE0LjQu9GPINC/0YDQuCDRgNC10LTQsNC60YLQuNGA0L7QstCw0L3QuNC4XHJcblxyXG5mdW5jdGlvbiBwYXRjaFByb2ZpbGUoKSB7XHJcbiAgcmV0dXJuIGZldGNoKCdodHRwczovL25vbW9yZXBhcnRpZXMuY28vdjEvd2JjLWNvaG9ydC0xL3VzZXJzL21lJywge1xyXG4gICAgbWV0aG9kOiAnUEFUQ0gnLFxyXG4gICAgaGVhZGVyczoge1xyXG4gICAgICBhdXRob3JpemF0aW9uOiAnZjY5YThlMWEtN2I0Yy00ODk4LTlmMzMtOTc1MzlkY2EzYzBjJyxcclxuICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xyXG4gICAgfSxcclxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgbmFtZTogcHJvZmlsZU5hbWUudGV4dENvbnRlbnQsXHJcbiAgICAgIGFib3V0OiBwcm9maWxlUHJvZmVzc2lvbi50ZXh0Q29udGVudCxcclxuICAgIH0pXHJcbiAgfSlcclxuICAgIC50aGVuKHJlcyA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSlcclxuICAgIC50aGVuKChyZXN1bHQpID0+IHtcclxuICAgICAgY29uc29sZS5sb2cocmVzdWx0KTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHBhdGNoQXZhdGFyKCkge1xyXG4gIHJldHVybiBmZXRjaCgnaHR0cHM6Ly9ub21vcmVwYXJ0aWVzLmNvL3YxL3diYy1jb2hvcnQtMS91c2Vycy9tZS9hdmF0YXInLCB7IC8vINC80LXQvdGP0LXQvCDQsNCy0LDRgtCw0YBcclxuICAgIG1ldGhvZDogJ1BBVENIJyxcclxuICAgIGhlYWRlcnM6IHtcclxuICAgICAgYXV0aG9yaXphdGlvbjogJ2Y2OWE4ZTFhLTdiNGMtNDg5OC05ZjMzLTk3NTM5ZGNhM2MwYycsXHJcbiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICAgIH0sXHJcbiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgIGF2YXRhcjogYXZhdGFySW1hZ2Uuc3JjLFxyXG4gICAgfSlcclxuICB9KVxyXG4gICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KVxyXG4gICAgLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICB9KTtcclxufVxyXG5cclxuLy8g0L7RgtC/0YDQsNCy0LvRj9C10Lwg0L3QvtCy0YPRjiDQutCw0YDRgtC+0YfQutGDINC90LAg0YHQtdGA0LLQtdGAXHJcbmZ1bmN0aW9uIGdldE5ld0NhcmQob2JqKSB7XHJcbiAgcmV0dXJuIGZldGNoKCdodHRwczovL25vbW9yZXBhcnRpZXMuY28vdjEvd2JjLWNvaG9ydC0xL2NhcmRzJywge1xyXG4gICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICBoZWFkZXJzOiB7XHJcbiAgICAgIGF1dGhvcml6YXRpb246ICdmNjlhOGUxYS03YjRjLTQ4OTgtOWYzMy05NzUzOWRjYTNjMGMnLFxyXG4gICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICB9LFxyXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICBuYW1lOiBhZGRJbWFnZU5hbWVJbnB1dC52YWx1ZSxcclxuICAgICAgbGluazogYWRkSW1hZ2VMaW5rSW5wdXQudmFsdWUsXHJcbiAgICAgIGxpa2VzOiBvYmoubGlrZXMubGVuZ3RoXHJcbiAgICB9KVxyXG4gIH0pXHJcbiAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pXHJcbiAgICAudGhlbigocmVzdWx0KSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBwdXRMaWtlKGNhcmRJZCkge1xyXG4gIHJldHVybiBmZXRjaChgaHR0cHM6Ly9ub21vcmVwYXJ0aWVzLmNvL3YxL3diYy1jb2hvcnQtMS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XHJcbiAgICBtZXRob2Q6ICdQVVQnLFxyXG4gICAgaGVhZGVyczoge1xyXG4gICAgICBhdXRob3JpemF0aW9uOiAnZjY5YThlMWEtN2I0Yy00ODk4LTlmMzMtOTc1MzlkY2EzYzBjJyxcclxuICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xyXG4gICAgfSxcclxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgIH0pXHJcbiAgfSlcclxuICAgIC50aGVuKHJlcyA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSlcclxuICAgIC50aGVuKChyZXN1bHQpID0+IHtcclxuICAgICAgY29uc29sZS5sb2cocmVzdWx0KTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRlbGV0ZUxpa2UoY2FyZElkKSB7XHJcbiAgcmV0dXJuIGZldGNoKGBodHRwczovL25vbW9yZXBhcnRpZXMuY28vdjEvd2JjLWNvaG9ydC0xL2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcclxuICAgIG1ldGhvZDogJ0RFTEVURScsXHJcbiAgICBoZWFkZXJzOiB7XHJcbiAgICAgIGF1dGhvcml6YXRpb246ICdmNjlhOGUxYS03YjRjLTQ4OTgtOWYzMy05NzUzOWRjYTNjMGMnLFxyXG4gICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICB9LFxyXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgfSlcclxuICB9KVxyXG4gICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KVxyXG4gICAgLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICB9KTtcclxufVxyXG5cclxuLy8g0YPQtNCw0LvRj9C10Lwg0LrQsNGA0YLQvtGH0LrRgyDQvdCwINGB0LXRgNCy0LXRgNC1XHJcbmZ1bmN0aW9uIGRlbGV0ZUNhcmQoY2FyZElkKSB7XHJcbiAgcmV0dXJuIGZldGNoKGBodHRwczovL25vbW9yZXBhcnRpZXMuY28vdjEvd2JjLWNvaG9ydC0xL2NhcmRzLyR7Y2FyZElkfWAsIHtcclxuICAgIG1ldGhvZDogJ0RFTEVURScsXHJcbiAgICBoZWFkZXJzOiB7XHJcbiAgICAgIGF1dGhvcml6YXRpb246ICdmNjlhOGUxYS03YjRjLTQ4OTgtOWYzMy05NzUzOWRjYTNjMGMnLFxyXG4gICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICB9LFxyXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgfSlcclxuICB9KVxyXG4gICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KVxyXG4gICAgLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycik7IC8vINCy0YvQstC+0LTQuNC8INC+0YjQuNCx0LrRgyDQsiDQutC+0L3RgdC+0LvRjFxyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCB7XHJcbiAgbXlJRCxcclxuICBnZXRVc2VySW5mbyxcclxuICBwYXRjaFByb2ZpbGUsXHJcbiAgcGF0Y2hBdmF0YXIsXHJcbiAgZ2V0TmV3Q2FyZCxcclxuICBkZWxldGVDYXJkLFxyXG4gIHB1dExpa2UsXHJcbiAgZGVsZXRlTGlrZVxyXG59OyIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmNvbnN0IHByb2ZpbGVQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZWRpdC1wcm9maWxlJyk7XHJcbmNvbnN0IGNhcmRQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fYWRkLWNhcmQnKTtcclxuY29uc3QgaW1hZ2VQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fdmlldy1pbWFnZScpO1xyXG5jb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX190aXRsZScpO1xyXG5jb25zdCBwcm9maWxlUHJvZmVzc2lvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19zdWJ0aXRsZScpO1xyXG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19lZGl0LWJ1dHRvbicpO1xyXG5jb25zdCBhZGRDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2FkZC1idXR0b24nKTtcclxuY29uc3QgaW5wdXRGdWxsTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9XCJmdWxsbmFtZVwiXScpO1xyXG5jb25zdCBpbnB1dFByb2Zlc3Npb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPVwicHJvZmVzc2lvblwiXScpO1xyXG5jb25zdCBhZGRJbWFnZU5hbWVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9XCJpbWFnZS1uYW1lXCJdJyk7XHJcbmNvbnN0IGFkZEltYWdlTGlua0lucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT1cImltYWdlLWxpbmtcIl0nKTtcclxuY29uc3QgcHJvZmlsZUVkaXRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZm9ybVtuYW1lPVwiZWRpdC1mb3JtXCJdJyk7XHJcbmNvbnN0IGFkZEltYWdlRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2Zvcm1bbmFtZT1cImFkZC1mb3JtXCJdJyk7XHJcbmNvbnN0IHVwZGF0ZUF2YXRhclBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX191cGRhdGUtYXZhdGFyJyk7XHJcbmNvbnN0IGF2YXRhckltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2F2YXRhci1pbWFnZScpO1xyXG5jb25zdCB1cGRhdGVBdmF0YXJGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZm9ybVtuYW1lPVwidXBkYXRlLWF2YXRhci1mb3JtXCJdJyk7XHJcbmNvbnN0IGF2YXRhckxpbmtJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9XCJhdmF0YXItbGlua1wiXScpO1xyXG5cclxuaW1wb3J0IHtcclxuICBhbGxGb3JtcyxcclxuICBhbGxJbnB1dHMsXHJcbiAgZGlzYWJsZVNhdmVCdXR0b24sXHJcbiAgaGlkZUVycm9yLFxyXG4gIHNlbGVjdG9ycyxcclxuICBsb2FkQ2FsbGJhY2tcclxufSBmcm9tICcuL3ZhbGlkYXRlLmpzJztcclxuXHJcbmltcG9ydCB7XHJcbiAgY2FyZExpc3QsXHJcbiAgaW1hZ2VDYXJkLFxyXG4gIHRpdGxlQ2FyZCxcclxuICBjcmVhdGVDYXJkXHJcbn0gZnJvbSAnLi9jYXJkLmpzJztcclxuXHJcbmltcG9ydCB7XHJcbiAgcGF0Y2hQcm9maWxlLFxyXG4gIHBhdGNoQXZhdGFyLFxyXG4gIGdldE5ld0NhcmQsXHJcbiAgbXlJRFxyXG59IGZyb20gJy4vYXBpLmpzJztcclxuXHJcbmZ1bmN0aW9uIG9wZW5Qb3B1cChwb3B1cCkge1xyXG4gIGRpc2FibGVTYXZlQnV0dG9uKCk7XHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMocG9wdXApO1xyXG4gIHBvcHVwLmNsYXNzTGlzdC5hZGQoJ3BvcHVwX29wZW5lZCcpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjbG9zZVBvcHVwKHBvcHVwKSB7XHJcbiAgcG9wdXAuY2xhc3NMaXN0LnJlbW92ZSgncG9wdXBfb3BlbmVkJyk7XHJcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGNsb3NlYkJ5RXNjYXBlKTtcclxuICBhbGxGb3Jtcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICBpdGVtLnJlc2V0KCk7XHJcbiAgfSk7XHJcbiAgYWxsSW5wdXRzLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgIGhpZGVFcnJvcihpdGVtKTtcclxuICB9KTtcclxufVxyXG5cclxuYXZhdGFySW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgb3BlblBvcHVwKHVwZGF0ZUF2YXRhclBvcHVwKTtcclxufSk7XHJcblxyXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICBvcGVuUG9wdXAocHJvZmlsZVBvcHVwKTtcclxuICBpbnB1dEZ1bGxOYW1lLnZhbHVlID0gcHJvZmlsZU5hbWUudGV4dENvbnRlbnQ7XHJcbiAgaW5wdXRQcm9mZXNzaW9uLnZhbHVlID0gcHJvZmlsZVByb2Zlc3Npb24udGV4dENvbnRlbnQ7XHJcbn0pO1xyXG5cclxuYWRkQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICBvcGVuUG9wdXAoY2FyZFBvcHVwKTtcclxufSk7XHJcblxyXG5mdW5jdGlvbiBzZXRFdmVudExpc3RlbmVycyhwb3B1cCkge1xyXG4gIGNvbnN0IGNsb3NlQnV0dG9uID0gcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19idXR0b24tY2xvc2UnKTtcclxuICBwb3B1cC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoZXZ0KSA9PiB7XHJcbiAgICBpZiAoZXZ0LnRhcmdldCA9PT0gY2xvc2VCdXR0b24pIHtcclxuICAgICAgY2xvc2VQb3B1cChwb3B1cCk7XHJcbiAgICB9XHJcbiAgICBpZiAoZXZ0LnRhcmdldCA9PT0gcG9wdXApIHtcclxuICAgICAgY2xvc2VQb3B1cChwb3B1cCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGNsb3NlYkJ5RXNjYXBlKTtcclxufVxyXG5cclxuZnVuY3Rpb24gY2xvc2ViQnlFc2NhcGUoZXZ0KSB7XHJcbiAgaWYgKGV2dC5jb2RlID09PSAnRXNjYXBlJykge1xyXG4gICAgY29uc3Qgb3BlbmVkUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfb3BlbmVkJyk7XHJcbiAgICBjbG9zZVBvcHVwKG9wZW5lZFBvcHVwKTtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHN1Ym1pdEZvcm0oKSB7XHJcbiAgcHJvZmlsZUVkaXRGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IHtcclxuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBpbnB1dEZ1bGxOYW1lLnZhbHVlO1xyXG4gICAgcHJvZmlsZVByb2Zlc3Npb24udGV4dENvbnRlbnQgPSBpbnB1dFByb2Zlc3Npb24udmFsdWU7XHJcbiAgICBwYXRjaFByb2ZpbGUoKTtcclxuICAgIGxvYWRDYWxsYmFjayhldnQpO1xyXG4gICAgY2xvc2VQb3B1cChwcm9maWxlUG9wdXApO1xyXG4gIH0pO1xyXG4gIGFkZEltYWdlRm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZXZ0KSA9PiB7XHJcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIGxldCBvYmpDYXJkID0ge1xyXG4gICAgICBfaWQ6ICcnLFxyXG4gICAgICBsaW5rOiBhZGRJbWFnZUxpbmtJbnB1dC52YWx1ZSxcclxuICAgICAgbmFtZTogYWRkSW1hZ2VOYW1lSW5wdXQudmFsdWUsXHJcbiAgICAgIGxpa2VzOiBbXSxcclxuICAgICAgb3duZXI6IHtcclxuICAgICAgICBfaWQ6IG15SUQsXHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgICBjYXJkTGlzdC5wcmVwZW5kKGNyZWF0ZUNhcmQob2JqQ2FyZCkpO1xyXG4gICAgZ2V0TmV3Q2FyZChvYmpDYXJkKTtcclxuICAgIGxvYWRDYWxsYmFjayhldnQpO1xyXG4gICAgY2xvc2VQb3B1cChjYXJkUG9wdXApO1xyXG4gIH0pO1xyXG4gIHVwZGF0ZUF2YXRhckZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGV2dCkgPT4ge1xyXG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBjb25zb2xlLmxvZyhhdmF0YXJMaW5rSW5wdXQudmFsdWUpO1xyXG4gICAgYXZhdGFySW1hZ2Uuc3JjID0gYXZhdGFyTGlua0lucHV0LnZhbHVlO1xyXG4gICAgcGF0Y2hBdmF0YXIoKTtcclxuICAgIGxvYWRDYWxsYmFjayhldnQpO1xyXG4gICAgY2xvc2VQb3B1cCh1cGRhdGVBdmF0YXJQb3B1cCk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCB7XHJcbiAgcHJvZmlsZVBvcHVwLFxyXG4gIGNhcmRQb3B1cCxcclxuICBpbWFnZVBvcHVwLFxyXG4gIHByb2ZpbGVOYW1lLFxyXG4gIHByb2ZpbGVQcm9mZXNzaW9uLFxyXG4gIGFkZEltYWdlTmFtZUlucHV0LFxyXG4gIGFkZEltYWdlTGlua0lucHV0LFxyXG4gIGF2YXRhckxpbmtJbnB1dCxcclxuICBhdmF0YXJJbWFnZSxcclxuICBvcGVuUG9wdXAsXHJcbiAgY2xvc2VQb3B1cCxcclxuICBzZXRFdmVudExpc3RlbmVycyxcclxuICBzdWJtaXRGb3JtXHJcbn07IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuaW1wb3J0IHtcclxuICBvcGVuUG9wdXAsXHJcbiAgaW1hZ2VQb3B1cFxyXG59IGZyb20gJy4vbW9kYWwnO1xyXG5cclxuaW1wb3J0IHtcclxuICBnZXROZXdDYXJkLFxyXG4gIG15SUQsXHJcbiAgZGVsZXRlQ2FyZCxcclxuICBwdXRMaWtlLFxyXG4gIGRlbGV0ZUxpa2VcclxufSBmcm9tICcuL2FwaS5qcyc7XHJcblxyXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjY2FyZCcpLmNvbnRlbnQ7XHJcbmNvbnN0IGNhcmRMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRzJyk7XHJcbmNvbnN0IGNhcmQgPSBjYXJkVGVtcGxhdGUucXVlcnlTZWxlY3RvcignLmVsZW1lbnQnKTtcclxuY29uc3QgaW1hZ2VQb3B1cEltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbWFnZScpO1xyXG5jb25zdCBpbWFnZUNhcmQgPSBjYXJkLnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X19pbWFnZScpO1xyXG5jb25zdCB0aXRsZUNhcmQgPSBjYXJkLnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X190aXRsZScpO1xyXG5jb25zdCBpbWFnZVBvcHVwVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX3RpdGxlJyk7XHJcblxyXG5mdW5jdGlvbiBhZGRJbml0aWFsQ2FyZHMoYXJyKSB7XHJcbiAgT2JqZWN0LmtleXMoYXJyKS5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICBjYXJkTGlzdC5hcHBlbmQoY3JlYXRlQ2FyZChhcnJbaXRlbV0pKTtcclxuICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gZGVsZXRlQnV0dG9ucyhhcnIpIHtcclxuICBPYmplY3Qua2V5cyhhcnIpLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgIGNvbnN0IGVsZW0gPSBjcmVhdGVDYXJkKGFycltpdGVtXSk7XHJcbiAgICBjb25zdCBkZWxldGVCdXR0b24gPSBlbGVtLnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X19kZWxldGUtYnV0dG9uJyk7XHJcbiAgICBkZWxldGVCdXR0b24ucmVtb3ZlKCk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoaXRlbSkge1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZC5jbG9uZU5vZGUodHJ1ZSksXHJcbiAgICBpbWFnZUNhcmRFbGVtZW50ID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX2ltYWdlJyksXHJcbiAgICB0aXRsZUNhcmRFbGVtZW50ID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX3RpdGxlJyksXHJcbiAgICBsaWtlQnV0dG9uQ2FyZEVsZW1lbnQgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9fbGlrZS1idXR0b24nKSxcclxuICAgIGRlbGV0ZUJ1dHRvbkNhcmRFbGVtZW50ID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX2RlbGV0ZS1idXR0b24nKSxcclxuICAgIGxpa2VDb3VudCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X19saWtlLWNvdW50Jyk7XHJcbiAgY2FyZEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZ0KSA9PiB7XHJcbiAgICBpZiAoZXZ0LnRhcmdldCA9PT0gbGlrZUJ1dHRvbkNhcmRFbGVtZW50KSB7XHJcbiAgICAgIGlmICghbGlrZUJ1dHRvbkNhcmRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnZWxlbWVudF9fbGlrZS1idXR0b25fYWN0aXZlJykpIHtcclxuICAgICAgICBsaWtlQnV0dG9uQ2FyZEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZWxlbWVudF9fbGlrZS1idXR0b25fYWN0aXZlJyk7XHJcbiAgICAgICAgbGlrZUNvdW50LnRleHRDb250ZW50ID0gYCR7K2xpa2VDb3VudC50ZXh0Q29udGVudCArIDF9YDtcclxuICAgICAgICBwdXRMaWtlKGV2dC50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUuaWQpO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgIGxpa2VCdXR0b25DYXJkRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdlbGVtZW50X19saWtlLWJ1dHRvbl9hY3RpdmUnKTtcclxuICAgICAgICBsaWtlQ291bnQudGV4dENvbnRlbnQgPSBgJHsrbGlrZUNvdW50LnRleHRDb250ZW50IC0gMX1gO1xyXG4gICAgICAgIGRlbGV0ZUxpa2UoZXZ0LnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5pZCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGlmIChldnQudGFyZ2V0ID09PSBpbWFnZUNhcmRFbGVtZW50KSB7XHJcbiAgICAgIGltYWdlUG9wdXBJbWFnZS5zcmMgPSBldnQudGFyZ2V0LnNyYztcclxuICAgICAgaW1hZ2VQb3B1cEltYWdlLmFsdCA9IGV2dC50YXJnZXQuYWx0O1xyXG4gICAgICBpbWFnZVBvcHVwVGl0bGUudGV4dENvbnRlbnQgPSB0aXRsZUNhcmRFbGVtZW50LnRleHRDb250ZW50O1xyXG4gICAgICBvcGVuUG9wdXAoaW1hZ2VQb3B1cCk7XHJcbiAgICB9XHJcbiAgICBpZiAoZXZ0LnRhcmdldCA9PT0gZGVsZXRlQnV0dG9uQ2FyZEVsZW1lbnQpIHtcclxuICAgICAgZGVsZXRlQnV0dG9uQ2FyZEVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmUoKTtcclxuICAgICAgZGVsZXRlQ2FyZChldnQudGFyZ2V0LnBhcmVudE5vZGUuaWQpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG4gIGltYWdlQ2FyZEVsZW1lbnQuc3JjID0gaXRlbS5saW5rO1xyXG4gIGltYWdlQ2FyZEVsZW1lbnQuYWx0ID0gaXRlbS5uYW1lO1xyXG4gIHRpdGxlQ2FyZEVsZW1lbnQudGV4dENvbnRlbnQgPSBpdGVtLm5hbWU7XHJcbiAgbGlrZUNvdW50LnRleHRDb250ZW50ID0gaXRlbS5saWtlcy5sZW5ndGg7XHJcbiAgY2FyZEVsZW1lbnQuaWQgPSBpdGVtLl9pZDtcclxuICBpZiAoaXRlbS5vd25lci5faWQgIT09IG15SUQpIHtcclxuICAgIGRlbGV0ZUJ1dHRvbkNhcmRFbGVtZW50LnJlbW92ZSgpO1xyXG4gIH1cclxuICBpZiAoaXRlbS5saWtlcy5sZW5ndGggIT09IDApIHtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaXRlbS5saWtlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgaWYoaXRlbS5saWtlc1tpXS5faWQgPT09IG15SUQpIHtcclxuICAgICAgbGlrZUJ1dHRvbkNhcmRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2VsZW1lbnRfX2xpa2UtYnV0dG9uX2FjdGl2ZScpO1xyXG4gICAgfVxyXG4gICAgfVxyXG4gIH1cclxuICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbn1cclxuXHJcbmV4cG9ydCB7XHJcbiAgY2FyZFRlbXBsYXRlLFxyXG4gIGNhcmRMaXN0LFxyXG4gIGNhcmQsXHJcbiAgaW1hZ2VDYXJkLFxyXG4gIHRpdGxlQ2FyZCxcclxuICBhZGRJbml0aWFsQ2FyZHMsXHJcbiAgY3JlYXRlQ2FyZCxcclxuICBkZWxldGVCdXR0b25zXHJcbn07Il0sIm5hbWVzIjpbInNlbGVjdG9ycyIsImFsbElucHV0cyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImFsbEZvcm1zIiwiYWxsU2F2ZUJ1dHRvbnMiLCJzYXZlQnV0dG9uIiwicXVlcnlTZWxlY3RvciIsImxvYWRDYWxsYmFjayIsImV2dCIsIml0ZW0iLCJ0YXJnZXQiLCJvbmxvYWQiLCJ0ZXh0Q29udGVudCIsImhpZGVFcnJvciIsImNsYXNzTGlzdCIsInJlbW92ZSIsIm5leHRFbGVtZW50U2libGluZyIsImNvbnNvbGUiLCJkaXIiLCJteUlEIiwicHJvZmlsZVBvcHVwIiwiY2FyZFBvcHVwIiwiaW1hZ2VQb3B1cCIsInByb2ZpbGVOYW1lIiwicHJvZmlsZVByb2Zlc3Npb24iLCJwcm9maWxlRWRpdEJ1dHRvbiIsImFkZENhcmRCdXR0b24iLCJpbnB1dEZ1bGxOYW1lIiwiaW5wdXRQcm9mZXNzaW9uIiwiYWRkSW1hZ2VOYW1lSW5wdXQiLCJhZGRJbWFnZUxpbmtJbnB1dCIsInByb2ZpbGVFZGl0Rm9ybSIsImFkZEltYWdlRm9ybSIsInVwZGF0ZUF2YXRhclBvcHVwIiwiYXZhdGFySW1hZ2UiLCJ1cGRhdGVBdmF0YXJGb3JtIiwiYXZhdGFyTGlua0lucHV0Iiwib3BlblBvcHVwIiwicG9wdXAiLCJmb3JFYWNoIiwiYWRkIiwiZGlzYWJsZWQiLCJjbG9zZUJ1dHRvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJjbG9zZVBvcHVwIiwiY2xvc2ViQnlFc2NhcGUiLCJzZXRFdmVudExpc3RlbmVycyIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJyZXNldCIsImNvZGUiLCJ2YWx1ZSIsImNhcmRUZW1wbGF0ZSIsImNvbnRlbnQiLCJjYXJkTGlzdCIsImNhcmQiLCJpbWFnZVBvcHVwSW1hZ2UiLCJpbWFnZVBvcHVwVGl0bGUiLCJjcmVhdGVDYXJkIiwiY2FyZEVsZW1lbnQiLCJjbG9uZU5vZGUiLCJpbWFnZUNhcmRFbGVtZW50IiwidGl0bGVDYXJkRWxlbWVudCIsImxpa2VCdXR0b25DYXJkRWxlbWVudCIsImRlbGV0ZUJ1dHRvbkNhcmRFbGVtZW50IiwibGlrZUNvdW50IiwiY2FyZElkIiwiY29udGFpbnMiLCJmZXRjaCIsIm1ldGhvZCIsImhlYWRlcnMiLCJhdXRob3JpemF0aW9uIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsInJlc3VsdCIsImxvZyIsImNhdGNoIiwiZXJyIiwiZGVsZXRlTGlrZSIsInBhcmVudE5vZGUiLCJpZCIsInNyYyIsImFsdCIsImRlbGV0ZUNhcmQiLCJsaW5rIiwibmFtZSIsImxpa2VzIiwibGVuZ3RoIiwiX2lkIiwib3duZXIiLCJpIiwicHJldmVudERlZmF1bHQiLCJhYm91dCIsIm9iaiIsIm9iakNhcmQiLCJwcmVwZW5kIiwiYXZhdGFyIiwidmFsaWRpdHkiLCJ2YWxpZCIsInNob3dFcnJvciIsInRhcmdldEZvcm0iLCJmb3JtIiwiaXNWYWxpZCIsImNoZWNrVmFsaWRpdHkiLCJhcnIiLCJPYmplY3QiLCJrZXlzIiwiYXBwZW5kIl0sInNvdXJjZVJvb3QiOiIifQ==